<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>EcoTrack â€“ Search</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body class="page-feed">

    <!-- Sidebar -->
    <aside class="sidebar">

        <a href="{{ url_for('about') }}" class="sidebar-item sidebar-logo">
            <img src="{{ url_for('static', filename='images/ecotrack.png') }}" class="icon">
            <span class="tooltip">EcoTrack</span>
        </a>

        <a href="{{ url_for('home') }}" class="sidebar-item">
            <img src="{{ url_for('static', filename='images/home.png') }}" class="icon">
            <span class="tooltip">Home</span>
        </a>

        <a href="{{ url_for('create_post') }}" class="sidebar-item">
            <img src="{{ url_for('static', filename='images/post.png') }}" class="icon">
            <span class="tooltip">Create Post</span>
        </a>

        <a href="{{ url_for('search') }}" class="sidebar-item active">
            <img src="{{ url_for('static', filename='images/search.png') }}" class="icon">
            <span class="tooltip">Search</span>
        </a>

        <a href="{{ url_for('rewards') }}" class="sidebar-item">
            <img src="{{ url_for('static', filename='images/rewards.png') }}" class="icon">
            <span class="tooltip">Rewards</span>
        </a>

        {% if current_user.is_authenticated %}
            <a href="{{ url_for('logout') }}" class="sidebar-item">
                <img src="{{ url_for('static', filename='images/logout.png') }}" class="icon">
                <span class="tooltip">Logout</span>
            </a>
        {% else %}
            <div class="sidebar-item has-dropdown">
                <img src="{{ url_for('static', filename='images/login.png') }}" class="icon">
                <span class="tooltip">Sign In / Register</span>
                <div class="sidebar-dropdown">
                    <a href="{{ url_for('login') }}">Sign In</a>
                    <a href="{{ url_for('register') }}">Register</a>
                </div>
            </div>
        {% endif %}

        <a href="{{ url_for('settings') }}" class="sidebar-item">
            <img src="{{ url_for('static', filename='images/settings.png') }}" class="icon">
            <span class="tooltip">Settings</span>
        </a>

    </aside>

    <main class="feed-container main-with-sidebar main-narrow">
        
        <div class="card search-header">
            <h2>Search Actions</h2>
            <form action="{{ url_for('search') }}" method="GET" class="search-form" style="display: flex; gap: 10px;">
                <input type="text" name="q" placeholder="Search for actions..." value="{{ query if query else '' }}" style="flex-grow: 1;">
                <button type="submit" class="btn-primary">Search</button>
            </form>
        </div>

        {% if query %}
            <h3 style="margin-top: 20px;">Results for "{{ query }}"</h3>
            
            {% if results %}
                {% for job in results %}
                <article class="feed-item card">
                    <header class="feed-header">
                        <div class="user-icon">
                            <img src="{{ url_for('static', filename=job.user_icon) if job.user_icon else url_for('static', filename='images/default.png') }}" class="user-icon">
                        </div>
                        <div>
                            <div class="feed-username">{{ job.username }}</div>
                            <div class="feed-timestamp">{{ job.date.strftime('%Y-%m-%d') }}</div>
                        </div>
                    </header>
                    
                    <div class="feed-image">
                        <img src="{{ url_for('static', filename=job.imagepath) }}" class="feed-image">
                    </div>
                    
                    <div class="feed-body">
                        <h4>{{ job.title }}</h4>
                        <p>{{ job.description }}</p>
                        <span class="badge">{{ job.type }}</span>
                    </div>
                </article>
                {% endfor %}
            {% else %}
                <p>No results found.</p>
            {% endif %}
            
        {% endif %}

    </main>

    <script src="{{ url_for('static', filename='script.js') }}"></script>

</body>
</html>