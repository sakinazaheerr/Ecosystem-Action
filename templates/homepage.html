<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>EcoTrack â€“ Home</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body class="page-feed">

    <!-- Sidebar -->
    <!-- Same for all pages -->
    <aside class="sidebar">

        <!-- Use url_for for page links -->
        <a href="{{ url_for('about') }}" class="sidebar-item sidebar-logo">
            <img src="{{ url_for('static', filename='images/ecotrack.png') }}" class="icon">
            <span class="tooltip">EcoTrack</span>
        </a>

        <a href="{{ url_for('home') }}" class="sidebar-item active">
            <img src="{{ url_for('static', filename='images/home.png') }}" class="icon">
            <span class="tooltip">Home</span>
        </a>

        <a href="{{ url_for('create_post') }}" class="sidebar-item">
            <img src="{{ url_for('static', filename='images/post.png') }}" class="icon">
            <span class="tooltip">Create Post</span>
        </a>

        <a href="{{ url_for('search') }}" class="sidebar-item">
            <img src="{{ url_for('static', filename='images/search.png') }}" class="icon">
            <span class="tooltip">Search</span>
        </a>

    

        <a href="{{ url_for('rewards') }}" class="sidebar-item">
            <img src="{{ url_for('static', filename='images/rewards.png') }}" class="icon">
            <span class="tooltip">Rewards</span>
        </a>

        <div class="sidebar-item has-dropdown">
            <img src="{{ url_for('static', filename='images/login.png') }}" class="icon">
            <span class="tooltip">Sign In / Register</span>
            <div class="sidebar-dropdown">
                <a href="{{ url_for('login') }}">Sign In</a>
                <a href="{{ url_for('register') }}">Register</a>
            </div>
        </div>

        <a href="{{ url_for('settings') }}" class="sidebar-item">
            <img src="{{ url_for('static', filename='images/settings.png') }}" class="icon">
            <span class="tooltip">Settings</span>
        </a>

        <a href="{{ url_for('logout') }}" class="sidebar-item">
            <h5>Logout</h5>
            <span class="tooltip">Logout</span>
        </a>


    </aside>
    
    <!-- Main content -->
    <main class="feed-container main-with-sidebar main-narrow">
    
     {% if user_role == 'admin' %}
        <h1>Admin</h1>
    {% elif user_role == 'manager' %}
        <h1> Manager</h1>
    {% elif user_role == 'user' %}
        <h1>{{ name }}</h1>
    {% endif %}
    <br>
   
    {% for job in jobs %}
    <article class="feed-item card">

        <header class="feed-header">
            <div class="user-icon">
                <img src="{{ url_for('static', filename=job.user_icon) }}"
                     class="user-icon">
            </div>
            
            <div>
                <div class="feed-username">{{ job.username }}</div>
                <div class="feed-timestamp">
                    {{ job.date.strftime('%b %d, %Y') }}
                </div>
                {% if user_role == 'admin' and job.username != 'admin' %}
                 <button onclick="window.location.href='{{ url_for('deleteuser', username = job.username) }}'">Delete/Block</button>

            {% endif %}
            </div>
        </header>

        <div class="feed-image">
            <img src="{{ url_for('static', filename=job.imagepath) }}"
                 class="feed-image">
        </div>

        <div class="feed-body">
            <div class = "horz">

                <h4>{{ job.title }} 
                    {% if user_role == 'admin' or user_role == 'manager'%}
                    
                    <h4>{{ job.status }}</h4>
                    
                    {% if job.status  == 'pending' %}
                    <button onclick="window.location.href= '{{ url_for('approve', job_id=job.jobid) }}' " >Approve Post</button>
                    <button onclick="window.location.href='{{ url_for('delete', job_id=job.jobid) }}'">Delete Post</button>
                    {% endif %}

                    {% if job.status  == 'active' %}
                    <button onclick="window.location.href='{{ url_for('delete', job_id=job.jobid) }}'">Delete Post</button>
                    {% endif %}
                    
                    
                    {% endif %}
                    
                    
                    
                </h4>
            </div>

            <p>{{ job.description }}</p>

            {% if user_role == 'user' %}

            <button onclick="window.location.href='{{ url_for('getpoints', jobid = job.jobid) }}'">Mark as Finished</button>

            {% endif %}
        </div>

    </article>
    {% endfor %}

    </main>

    <script src="{{ url_for('static', filename='script.js') }}"></script>

</body>
</html>